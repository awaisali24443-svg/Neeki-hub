<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Neeki Hub - Your Islamic Spiritual Dashboard with Quran, Hadith, Duas, Prayer times, and AI assistant">
    <meta name="theme-color" content="#050406">
    <title>Neeki Hub - Islamic Spiritual Dashboard</title>
    
    <!-- 
    ═══════════════════════════════════════════════════════════════════════
    NEEKI HUB - QUICK START GUIDE
    ═══════════════════════════════════════════════════════════════════════
    
    LOCAL TESTING:
    1. Run: node server.js
    2. Open: http://localhost:3000
    3. Service Worker will register automatically
    
    ENVIRONMENT VARIABLES (for server-side AI):
    - HF_API_KEY: Hugging Face API key (optional)
    - GEMINI_API_KEY: Google Gemini API key (optional)
    Set these in Render dashboard under Environment tab
    
    FEATURES:
    - Offline-capable PWA
    - Real-time prayer countdown with circular progress
    - Daily Islamic content (Quran, Hadith, Duas, Quotes)
    - AI Q&A assistant with source citations
    - Qibla finder with compass
    - Multi-language support (EN, Urdu, Pashto) with auto RTL
    - Focus management and keyboard navigation
    - Persistent chat history and bookmarks
    
    SERVICE WORKER:
    Automatically registers on load. Caches static assets and API responses
    for offline functionality. See sw.js for cache strategy.
    
    ═══════════════════════════════════════════════════════════════════════
    -->
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Scheherazade+New:wght@400;700&family=Noto+Nastaliq+Urdu:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="/assets/icons/icon-192x192.png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- Night Sky Background -->
    <div class="background" aria-hidden="true">
        <img src="/assets/horizon.svg" alt="" class="horizon" loading="lazy">
        <img src="/assets/moon.svg" alt="" class="moon" loading="lazy">
    </div>

    <!-- Header -->
    <header class="header" role="banner">
        <div class="brand">
            <span class="brand-text" aria-label="Neeki Hub">Neeki Hub</span>
        </div>
        <div class="header-controls">
            <button class="install-btn hidden" id="installBtn" aria-label="Install Neeki Hub as an app">
                <span>Install App</span>
            </button>
            <div class="lang-switcher" role="radiogroup" aria-label="Language selection">
                <button class="lang-btn active" data-lang="en" role="radio" aria-checked="true" aria-label="English">EN</button>
                <button class="lang-btn" data-lang="ur" role="radio" aria-checked="false" aria-label="اردو">اردو</button>
                <button class="lang-btn" data-lang="ps" role="radio" aria-checked="false" aria-label="پښتو">پښتو</button>
            </div>
        </div>
    </header>

    <!-- Floating Navigation -->
    <nav class="floating-nav" role="navigation" aria-label="Main navigation">
        <button class="nav-btn active" data-panel="home" aria-label="Home" title="Home">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
        </button>
        <button class="nav-btn" data-panel="quran" aria-label="Quran" title="Quran">
            <img src="/assets/icons/quran.svg" alt="" aria-hidden="true">
        </button>
        <button class="nav-btn" data-panel="dua" aria-label="Duas" title="Duas">
            <img src="/assets/icons/dua.svg" alt="" aria-hidden="true">
        </button>
        <button class="nav-btn" data-panel="hadith" aria-label="Hadith" title="Hadith">
            <img src="/assets/icons/hadith.svg" alt="" aria-hidden="true">
        </button>
        <button class="nav-btn" data-panel="quotes" aria-label="Quotes" title="Islamic Quotes">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"/>
                <path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"/>
            </svg>
        </button>
        <button class="nav-btn" data-panel="qibla" aria-label="Qibla Finder" title="Qibla Direction">
            <img src="/assets/icons/qibla.svg" alt="" aria-hidden="true">
        </button>
        <button class="nav-btn" data-panel="settings" aria-label="Settings" title="Settings">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <circle cx="12" cy="12" r="3"/>
                <path d="M12 1v6m0 6v6m9-9h-6m-6 0H3m15.364 6.364l-4.243-4.243m-6.364 0l-4.243 4.243m12.728 0l-4.243-4.243m-6.364 0L3.636 17.364"/>
            </svg>
        </button>
    </nav>

    <!-- Main Dashboard -->
    <main class="dashboard" role="main">
        <!-- Next Prayer Card -->
        <section class="glass-card next-prayer-card" aria-labelledby="next-prayer-title">
            <h2 id="next-prayer-title" class="card-title">Next Prayer</h2>
            <div class="prayer-info">
                <div class="prayer-name" id="nextPrayerName" aria-live="polite">Loading...</div>
                <div class="prayer-time" id="nextPrayerTime" aria-live="polite">--:--</div>
            </div>
            <div class="countdown-container">
                <svg class="countdown-ring" viewBox="0 0 200 200" aria-hidden="true">
                    <defs>
                        <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#b8860b;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#d4af37;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#f5d76e;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <circle cx="100" cy="100" r="90" class="ring-bg"/>
                    <circle cx="100" cy="100" r="90" class="ring-progress" id="progressRing"/>
                </svg>
                <div class="countdown-timer" id="countdownTimer" aria-live="polite" aria-atomic="true">00:00:00</div>
            </div>
            <div class="prayer-meta">
                <span id="cityName" class="skeleton">Loading city...</span>
                <span id="hijriDate" class="skeleton">Loading date...</span>
            </div>
        </section>

        <!-- Daily Carousel -->
        <section class="glass-card daily-carousel" aria-labelledby="daily-content-title">
            <h2 id="daily-content-title" class="sr-only">Daily Islamic Content</h2>
            <div class="carousel-tabs" role="tablist" aria-label="Content types">
                <button class="tab-btn active" data-type="verse" role="tab" aria-selected="true" aria-controls="carousel-panel">Ayah</button>
                <button class="tab-btn" data-type="hadith" role="tab" aria-selected="false" aria-controls="carousel-panel">Hadith</button>
                <button class="tab-btn" data-type="dua" role="tab" aria-selected="false" aria-controls="carousel-panel">Dua</button>
                <button class="tab-btn" data-type="quote" role="tab" aria-selected="false" aria-controls="carousel-panel">Quote</button>
            </div>
            <div class="carousel-content" id="carouselContent" role="tabpanel" id="carousel-panel" aria-live="polite">
                <div class="skeleton skeleton-text" style="height: 60px;"></div>
                <div class="skeleton skeleton-text" style="height: 40px; margin-top: 1rem;"></div>
            </div>
            <div class="carousel-actions">
                <button class="action-btn" id="nextContentBtn" aria-label="Load next content">
                    <img src="/assets/icons/next.svg" alt="" aria-hidden="true">
                    <span>Next</span>
                </button>
                <button class="action-btn" id="bookmarkBtn" aria-label="Bookmark this content">
                    <img src="/assets/icons/bookmark.svg" alt="" aria-hidden="true">
                    <span>Save</span>
                </button>
            </div>
        </section>

        <!-- Quick Access Grid -->
        <section class="quick-access-grid" aria-label="Quick access">
            <button class="quick-card" data-panel="qibla" aria-label="Open Qibla Finder">
                <img src="/assets/icons/qibla.svg" alt="" aria-hidden="true">
                <span>Qibla</span>
            </button>
            <button class="quick-card" data-panel="quran" aria-label="Learn Quran">
                <img src="/assets/icons/quran.svg" alt="" aria-hidden="true">
                <span>Learn Quran</span>
            </button>
            <button class="quick-card" data-panel="dua" aria-label="Browse Duas">
                <img src="/assets/icons/dua.svg" alt="" aria-hidden="true">
                <span>Duas</span>
            </button>
            <button class="quick-card" data-panel="hadith" aria-label="Read Hadith">
                <img src="/assets/icons/hadith.svg" alt="" aria-hidden="true">
                <span>Hadith</span>
            </button>
        </section>
    </main>

    <!-- Qibla Panel -->
    <aside class="panel" id="qiblaPanel" role="dialog" aria-labelledby="qiblaPanelTitle" aria-modal="true" aria-hidden="true">
        <div class="panel-header">
            <h2 id="qiblaPanelTitle">Qibla Finder</h2>
            <button class="panel-close" aria-label="Close Qibla finder">&times;</button>
        </div>
        <div class="panel-body">
            <div class="qibla-compass">
                <div class="compass-container">
                    <svg viewBox="0 0 200 200" class="compass-base" aria-hidden="true">
                        <circle cx="100" cy="100" r="90" fill="none" stroke="rgba(212,175,55,0.2)" stroke-width="1"/>
                        <text x="100" y="20" text-anchor="middle" class="compass-label">N</text>
                        <text x="180" y="105" text-anchor="middle" class="compass-label">E</text>
                        <text x="100" y="190" text-anchor="middle" class="compass-label">S</text>
                        <text x="20" y="105" text-anchor="middle" class="compass-label">W</text>
                    </svg>
                    <div class="compass-needle" id="compassNeedle" aria-hidden="true">
                        <div class="needle-point"></div>
                        <div class="kaaba-icon" aria-label="Direction to Kaaba">🕋</div>
                    </div>
                </div>
                <div class="qibla-info" role="status" aria-live="polite">
                    <div class="info-row">
                        <span>Direction:</span>
                        <strong id="qiblaDirection" aria-label="Qibla direction in degrees">--°</strong>
                    </div>
                    <div class="info-row">
                        <span>Distance:</span>
                        <strong id="qiblaDistance" aria-label="Distance to Kaaba">-- km</strong>
                    </div>
                </div>
                <button class="primary-btn" id="findQiblaBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <circle cx="12" cy="12" r="10"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                    Find Qibla Direction
                </button>
            </div>
        </div>
    </aside>

    <!-- Generic Content Panel -->
    <aside class="panel" id="contentPanel" role="dialog" aria-labelledby="contentPanelTitle" aria-modal="true" aria-hidden="true">
        <div class="panel-header">
            <h2 id="contentPanelTitle">Content</h2>
            <button class="panel-close" aria-label="Close panel">&times;</button>
        </div>
        <div class="panel-body" id="contentPanelBody">
            <p>Loading content...</p>
        </div>
    </aside>

    <!-- AI Chat Modal -->
    <div class="ai-chat-modal hidden" id="aiChatModal" role="dialog" aria-labelledby="aiChatTitle" aria-modal="true" aria-hidden="true">
        <div class="chat-header">
            <h3 id="aiChatTitle">
                <img src="/assets/icons/ai.svg" alt="" aria-hidden="true">
                Ask Neeki AI
            </h3>
            <button class="chat-close" aria-label="Close AI chat">&times;</button>
        </div>
        <div class="chat-messages" id="chatMessages" role="log" aria-live="polite" aria-atomic="false">
            <div class="chat-message bot">
                <p>السلام عليكم! Ask me any Islamic question.</p>
            </div>
        </div>
        <form class="chat-input-form" id="chatForm">
            <label for="chatInput" class="sr-only">Type your Islamic question</label>
            <input type="text" id="chatInput" placeholder="Ask your question..." aria-label="Chat input" autocomplete="off" required>
            <button type="submit" aria-label="Send message">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                    <line x1="22" y1="2" x2="11" y2="13"/>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                </svg>
            </button>
        </form>
    </div>

    <!-- AI Floating Action Button -->
    <button class="ai-fab" id="aiFab" aria-label="Open AI assistant" title="Ask Islamic questions">
        <img src="/assets/icons/ai.svg" alt="" aria-hidden="true">
    </button>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer" role="status" aria-live="polite" aria-atomic="true"></div>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <p>&copy; 2024 Neeki Hub. Built with ❤️ for the Ummah.</p>
    </footer>

    <!-- App Script -->
    <script src="/js/app.js"></script>
</body>
</html>